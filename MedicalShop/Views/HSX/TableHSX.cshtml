@model IEnumerable<MedicalShop.Models.Entities.Hsx>

@{
  Layout = "~/Views/Shared/_LayoutNV.cshtml";

  MedicalShopContext context = new MedicalShopContext();

  List<Hsx> listHSX()
  {
    return context.Hsx.Where(x => x.Active == true).ToList();
  }


    var quyen = ViewBag.Quyen;
    bool nhap = false, sua = false, xoa = false, print = false, xuat = false;
    nhap = (bool)quyen.Import;
    sua = (bool)quyen.Update;
    xoa = (bool)quyen.Delete;
    print = (bool)quyen.Print;
    xuat = (bool)quyen.Export;


}


<div style="display: flex; justify-content: space-between; flex-wrap: wrap;">
  <div style="margin-bottom: 20px">
    @if (nhap == true)
    {
      <a href="/HSX/ViewCreate" class="btn btn-secondary"><span>Thêm mới</span></a>
    }
    else
    {
      <button class="btn btn-secondary disabled"><span>Thêm mới</span></button>
    }
  </div>
  <div style="display: flex; justify-content: space-around; margin-bottom: 20px;">
    <div style="display: flex">
      <div class="dropdown" style="margin-right:10px">
        <select id="active" onchange="changeHH()" class="custom-select">
          <option value="true" selected>Hiện tại</option>
          <option value="false">Tất cả</option>
        </select>
      </div>
    </div>
  </div>
</div>

<div id="tableHSX" class="table-responsive" style="margin-bottom: 5rem">
  <table id="example" class="table table-striped" style="width:100%">
    <thead>
      <tr>
        <th>
          Mã HSX
        </th>
        <th>
          Tên HSX
        </th>
        <th>
          Địa chỉ
        </th>
        <th>
          SĐT
        </th>
        <th>
          Mail
        </th>
        <th>Tùy chọn</th>
      </tr>
    </thead>
    <tbody>
      @foreach (var item in Model)
      {
        <tr>
          <td>
            @Html.DisplayFor(modelItem => item.MaHsx)
          </td>
          <td>
            @Html.DisplayFor(modelItem => item.TenHsx)
          </td>
          <td>
            @Html.DisplayFor(modelItem => item.Address)
          </td>
          <td>
            @Html.DisplayFor(modelItem => item.Phone)
          </td>
          <td>
            @Html.DisplayFor(modelItem => item.Mail)
          </td>
          <td>
            @if (sua == true)
            {
              @Html.ActionLink(" ", "ViewUpdate", new { id = item.Id }, new { @class = "far fa-edit lighter" })
            }
            else
            {
              <button class=" btn p-0 disabled"><i class="far fa-edit"></i></button>
            }
            @Html.ActionLink(" ", "Details", new { id = item.Id }, new { @class = "fas fa-eye lighter" })
            @if (xoa == true)
            {
              @Html.ActionLink(" ", "Delete", new { id = item.Id }, new { @class = "fas fa-trash-alt lighter", onclick = "return confirm('Bạn muốn xoá đối tượng này?')" })
            }
            else
            {
              <button class=" btn p-0 disabled"><i class="fas fa-trash-alt"></i></button>
            }
          </td>
        </tr>
      }
    </tbody>
  </table>
</div>


<script>
  $('#active').on('change', function () {
    var a = $(this).val();
    $.ajax({
      type: "post",
      url: "/loadTableHSX",
      data: "active=" + a,
      success: function (result) {
        $('#tableHSX').replaceWith(result);
      },
      error: function () {
        alert("Failed");
      }
    });
  });
</script>

